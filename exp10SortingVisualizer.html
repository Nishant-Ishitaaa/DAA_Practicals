<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sorting Visualizer</title>
    <style>
      :root {
        --bg: #0f1724;
        --panel: #0b1220;
        --accent: #06b6d4;
        --muted: #94a3b8;
        --bar: #60a5fa;
        --swap: #fb7185;
        --compare: #facc15;
        --done: #34d399;
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI",
          Roboto, "Helvetica Neue", Arial;
      }
      html,
      body {
        height: 100%;
        margin: 0;
        background: linear-gradient(180deg, #071124 0%, #0f1724 100%);
        color: #e6eef6;
      }
      .container {
        max-width: 1100px;
        margin: 28px auto;
        padding: 18px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 12px;
        box-shadow: 0 6px 30px rgba(2, 6, 23, 0.6);
      }
      header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 14px;
      }
      h1 {
        font-size: 20px;
        margin: 0;
      }
      .controls {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        align-items: center;
      }
      .control {
        background: var(--panel);
        padding: 10px;
        border-radius: 10px;
        display: flex;
        gap: 8px;
        align-items: center;
      }
      label {
        font-size: 13px;
        color: var(--muted);
      }
      select,
      button,
      input[type="range"] {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: inherit;
        padding: 8px;
        border-radius: 8px;
        font-size: 14px;
      }
      button {
        cursor: pointer;
        border: none;
        background: var(--accent);
        color: #04202a;
        font-weight: 600;
      }
      button:disabled {
        opacity: 0.45;
        cursor: not-allowed;
        background: rgba(6, 182, 212, 0.35);
      }
      #array-container {
        height: 420px;
        display: flex;
        align-items: flex-end;
        gap: 2px;
        margin-top: 18px;
        padding: 12px;
        border-radius: 8px;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.015),
          rgba(255, 255, 255, 0.01)
        );
        overflow: hidden;
      }
      .bar {
        flex: 1 0 auto;
        border-radius: 4px;
        background: var(--bar);
        display: flex;
        align-items: flex-end;
        justify-content: center;
        font-size: 11px;
        color: rgba(0, 0, 0, 0.6);
        box-shadow: 0 1px 0 rgba(255, 255, 255, 0.02) inset;
      }
      .bar.small {
        font-size: 9px;
      }
      .note {
        margin-top: 12px;
        color: var(--muted);
        font-size: 13px;
      }
      footer {
        margin-top: 16px;
        color: var(--muted);
        font-size: 13px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .legend {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .chip {
        display: inline-flex;
        gap: 6px;
        align-items: center;
        padding: 6px 8px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.02);
        font-size: 12px;
      }
      .color-sample {
        width: 12px;
        height: 12px;
        border-radius: 3px;
      }
      @media (max-width: 720px) {
        .controls {
          flex-direction: column;
          align-items: stretch;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
          <rect
            x="2"
            y="2"
            width="20"
            height="20"
            rx="4"
            fill="#06b6d4"
            opacity="0.14"
          ></rect>
          <path
            d="M7 16h10M7 12h10M7 8h6"
            stroke="#06b6d4"
            stroke-width="1.6"
            stroke-linecap="round"
            stroke-linejoin="round"
          ></path>
        </svg>
        <div>
          <h1>Sorting Visualizer</h1>
          <div style="color: var(--muted); font-size: 13px">
            Visualize sorting algorithms step-by-step
          </div>
        </div>
      </header>

      <div class="controls">
        <div class="control">
          <label for="algo">Algorithm</label>
          <select id="algo">
            <option value="bubble">Bubble Sort</option>
            <option value="selection">Selection Sort</option>
            <option value="insertion">Insertion Sort</option>
            <option value="merge">Merge Sort</option>
            <option value="quick">Quick Sort</option>
          </select>
        </div>

        <div class="control">
          <label for="size">Size</label>
          <input id="size" type="range" min="10" max="120" value="40" />
          <span
            id="size-val"
            style="min-width: 36px; text-align: center; font-weight: 600"
            >40</span
          >
        </div>

        <div class="control">
          <label for="speed">Speed</label>
          <input id="speed" type="range" min="1" max="1000" value="150" />
          <span
            id="speed-val"
            style="min-width: 48px; text-align: center; font-weight: 600"
            >150ms</span
          >
        </div>

        <div class="control">
          <button id="new-array">Generate</button>
          <button id="start">Start</button>
        </div>

        <div class="control" style="margin-left: auto">
          <label>Array type</label>
          <select id="preset">
            <option value="random">Random</option>
            <option value="nearly-sorted">Nearly Sorted</option>
            <option value="reversed">Reversed</option>
            <option value="few-unique">Few Unique</option>
          </select>
        </div>
      </div>

      <div id="array-container" aria-live="polite"></div>

      <div class="note">
        Tip: increase size for longer arrays, decrease speed (ms) for faster
        animation. Controls are disabled while sorting.
      </div>

      <footer>
        <div class="legend">
          <span class="chip"
            ><span
              class="color-sample"
              style="background: var(--compare)"
            ></span
            >Comparing</span
          >
          <span class="chip"
            ><span class="color-sample" style="background: var(--swap)"></span
            >Swapping</span
          >
          <span class="chip"
            ><span class="color-sample" style="background: var(--done)"></span
            >Sorted</span
          >
        </div>
        <div>Made for your project â€¢ Works offline</div>
      </footer>
    </div>

    <script>
      // ====== Config & DOM ======
      const container = document.getElementById("array-container");
      const sizeSlider = document.getElementById("size");
      const speedSlider = document.getElementById("speed");
      const sizeVal = document.getElementById("size-val");
      const speedVal = document.getElementById("speed-val");
      const newArrayBtn = document.getElementById("new-array");
      const startBtn = document.getElementById("start");
      const algoSelect = document.getElementById("algo");
      const presetSelect = document.getElementById("preset");

      let arr = [];
      let isSorting = false;

      // update displays
      sizeSlider.addEventListener("input", () => {
        sizeVal.textContent = sizeSlider.value;
        generateArray();
      });
      speedSlider.addEventListener("input", () => {
        speedVal.textContent = speedSlider.value + "ms";
      });

      newArrayBtn.addEventListener("click", generateArray);
      startBtn.addEventListener("click", startSort);

      // ====== Utility functions ======
      function randomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function generateArray() {
        if (isSorting) return;
        const n = +sizeSlider.value;
        const preset = presetSelect.value;
        arr = new Array(n);
        if (preset === "random") {
          for (let i = 0; i < n; i++) arr[i] = randomInt(10, 400);
        } else if (preset === "nearly-sorted") {
          for (let i = 0; i < n; i++)
            arr[i] = Math.floor((i / n) * 380) + randomInt(-8, 12);
        } else if (preset === "reversed") {
          for (let i = 0; i < n; i++)
            arr[i] = Math.floor(((n - i) / n) * 380) + 5;
        } else if (preset === "few-unique") {
          const k = Math.max(3, Math.floor(n / 10));
          const vals = Array.from(
            { length: k },
            (_, i) => 40 + i * Math.floor(360 / k)
          );
          for (let i = 0; i < n; i++) arr[i] = vals[randomInt(0, k - 1)];
        }
        renderArray();
      }

      function renderArray(highlight = {}) {
        container.innerHTML = "";
        const maxVal = Math.max(...arr, 400);
        arr.forEach((v, i) => {
          const bar = document.createElement("div");
          bar.className = "bar";
          if (arr.length > 60) bar.classList.add("small");
          bar.style.height = ((v / maxVal) * 100).toFixed(2) + "%";
          bar.style.flexBasis = `${100 / arr.length}%`;
          // color based on highlight
          if (highlight.compare && highlight.compare.includes(i))
            bar.style.background = "var(--compare)";
          else if (highlight.swap && highlight.swap.includes(i))
            bar.style.background = "var(--swap)";
          else if (highlight.pivot === i)
            bar.style.background = "var(--compare)";
          else if (highlight.sorted && highlight.sorted.includes(i))
            bar.style.background = "var(--done)";
          else bar.style.background = "var(--bar)";
          // optional label when small arrays
          if (arr.length <= 30) bar.textContent = Math.round(v);
          container.appendChild(bar);
        });
      }

      function delay(ms) {
        return new Promise((res) => setTimeout(res, ms));
      }

      function disableControls() {
        isSorting = true;
        startBtn.disabled = true;
        newArrayBtn.disabled = true;
        sizeSlider.disabled = true;
        speedSlider.disabled = true;
        algoSelect.disabled = true;
        presetSelect.disabled = true;
      }
      function enableControls() {
        isSorting = false;
        startBtn.disabled = false;
        newArrayBtn.disabled = false;
        sizeSlider.disabled = false;
        speedSlider.disabled = false;
        algoSelect.disabled = false;
        presetSelect.disabled = false;
      }

      // ====== Sorting Algorithms (with visualization hooks) ======

      async function bubbleSort() {
        const n = arr.length;
        for (let i = 0; i < n - 1; i++) {
          for (let j = 0; j < n - 1 - i; j++) {
            renderArray({ compare: [j, j + 1] });
            await delay(+speedSlider.value);
            if (arr[j] > arr[j + 1]) {
              [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
              renderArray({ swap: [j, j + 1] });
              await delay(+speedSlider.value);
            }
          }
          // mark last sorted
          let sortedIdx = [];
          for (let k = n - i; k < n; k++) sortedIdx.push(k - 1);
          renderArray({ sorted: sortedIdx });
        }
      }

      async function selectionSort() {
        const n = arr.length;
        for (let i = 0; i < n - 1; i++) {
          let minIdx = i;
          for (let j = i + 1; j < n; j++) {
            renderArray({ compare: [minIdx, j] });
            await delay(+speedSlider.value);
            if (arr[j] < arr[minIdx]) minIdx = j;
          }
          if (minIdx !== i) {
            [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
            renderArray({ swap: [i, minIdx] });
            await delay(+speedSlider.value);
          }
          // mark i as sorted
          const done = Array.from({ length: i + 1 }, (_, k) => k);
          renderArray({ sorted: done });
        }
      }

      async function insertionSort() {
        const n = arr.length;
        for (let i = 1; i < n; i++) {
          let key = arr[i];
          let j = i - 1;
          while (j >= 0 && arr[j] > key) {
            renderArray({ compare: [j, j + 1] });
            await delay(+speedSlider.value);
            arr[j + 1] = arr[j];
            renderArray({ swap: [j, j + 1] });
            await delay(+speedSlider.value);
            j--;
          }
          arr[j + 1] = key;
          renderArray({ sorted: Array.from({ length: i + 1 }, (_, k) => k) });
          await delay(+speedSlider.value);
        }
      }

      // Merge sort: recursive with animation updating main array
      async function mergeSortWrapper() {
        await mergeSort(0, arr.length - 1);
      }
      async function mergeSort(l, r) {
        if (l >= r) return;
        const m = Math.floor((l + r) / 2);
        await mergeSort(l, m);
        await mergeSort(m + 1, r);
        await merge(l, m, r);
      }
      async function merge(l, m, r) {
        const left = arr.slice(l, m + 1);
        const right = arr.slice(m + 1, r + 1);
        let i = 0,
          j = 0,
          k = l;
        while (i < left.length && j < right.length) {
          renderArray({ compare: [k] });
          await delay(+speedSlider.value);
          if (left[i] <= right[j]) {
            arr[k++] = left[i++];
          } else {
            arr[k++] = right[j++];
          }
          renderArray({ swap: [k - 1] });
          await delay(+speedSlider.value);
        }
        while (i < left.length) {
          arr[k++] = left[i++];
          renderArray({ swap: [k - 1] });
          await delay(+speedSlider.value);
        }
        while (j < right.length) {
          arr[k++] = right[j++];
          renderArray({ swap: [k - 1] });
          await delay(+speedSlider.value);
        }
        // optional: show merged segment as sorted visually
        const sortedSegment = [];
        for (let idx = l; idx <= r; idx++) sortedSegment.push(idx);
        renderArray({ sorted: sortedSegment });
        await delay(Math.max(20, +speedSlider.value / 2));
      }

      // Quick sort with Lomuto partition
      async function quickSortWrapper() {
        await quickSort(0, arr.length - 1);
      }
      async function quickSort(low, high) {
        if (low < high) {
          const p = await partition(low, high);
          await quickSort(low, p - 1);
          await quickSort(p + 1, high);
        } else {
          // visualize single element as sorted
          if (low === high) {
            renderArray({ sorted: [low] });
            await delay(+speedSlider.value / 3);
          }
        }
      }
      async function partition(low, high) {
        const pivot = arr[high];
        let i = low;
        for (let j = low; j < high; j++) {
          renderArray({ compare: [j], pivot: high });
          await delay(+speedSlider.value);
          if (arr[j] < pivot) {
            [arr[i], arr[j]] = [arr[j], arr[i]];
            renderArray({ swap: [i, j] });
            await delay(+speedSlider.value);
            i++;
          }
        }
        [arr[i], arr[high]] = [arr[high], arr[i]];
        renderArray({ swap: [i, high] });
        await delay(+speedSlider.value);
        // mark pivot position as sorted
        renderArray({ sorted: [i] });
        await delay(+speedSlider.value / 2);
        return i;
      }

      // ====== Runner ======
      async function startSort() {
        if (isSorting) return;
        disableControls();
        const algo = algoSelect.value;
        try {
          if (algo === "bubble") await bubbleSort();
          else if (algo === "selection") await selectionSort();
          else if (algo === "insertion") await insertionSort();
          else if (algo === "merge") await mergeSortWrapper();
          else if (algo === "quick") await quickSortWrapper();
          // final render: mark all sorted
          renderArray({
            sorted: Array.from({ length: arr.length }, (_, i) => i),
          });
        } catch (err) {
          console.error("Sorting error:", err);
        } finally {
          enableControls();
        }
      }

      // initial
      generateArray();
    </script>
  </body>
</html>
